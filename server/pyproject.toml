[tool.black]
line-length = 100
skip-string-normalization = true
target-version = ["py38"]
exclude = '\.eggs|\.git|\.mypy_cache|\.tox|\.env|\.venv|env|venv|_build|buck-out|build|dist'

[tool.isort]
profile = "black"
line_length = 100
# Sort by name, don't cluster "from" vs "import"
force_sort_within_sections = true
# Combines "as" imports on the same line
combine_as_imports = true

[tool.mypy]
python_version = 3.8
ignore_missing_imports = true
show_error_context = true
show_column_numbers = true
show_error_codes = true
pretty = true
exclude = '\.eggs|\.git|\.mypy_cache|\.tox|\.env|\.venv|env|venv|_build|buck-out|build|dist'

[tool.poetry]
name = "dive_server"
version = "1.0.0"
description = "DIVE Data Server"
authors = ["Kitware, Inc. <viame-web@kitware.com>"]
license = "Apache 2.0"
include = ["**/*.mako"]
readme = "README.md"
keywords = ["DIVE", "VIAME", "Annotation", "Computer Vision", "Marine"]
classifiers = [
  "License :: OSI Approved :: Apache Software License",
  "Natural Language :: English",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.8",
  "Programming Language :: Python :: 3.9",
]
packages = [
  { include = "bucket_notifications" },
  { include = "dive_server" },
  { include = "dive_tasks" },
  { include = "dive_utils" },
  { include = "rabbitmq_user_queues" },
]

[tool.poetry.dependencies]
python = ">=3.8,<3.10"
cheroot = ">=8.4.5"
click = "^8.1.3"
girder = "3.1.14"
girder_jobs = "3.1.14"
girder_worker = "0.8.1"
girder_worker_utils = "0.8.7"
pydantic = "1.9.0"
pyrabbit2 = "1.0.7"
typing-extensions = "^4.2.0"
GPUtil = "^1.4.0"
requests = ">=2.27.1"
urllib3 = "<1.27"
girder-large-image = "^1.14.4"
large-image = "^1.14.4"
large-image-source-pil = "^1.14.4"
simplejpeg = "^1.6.4"
large-image-tasks = "^1.14.4"
large-image-converter = "^1.14.4"
gdal = {url = "https://girder.github.io/large_image_wheels/GDAL-3.5.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl"}
bitarray = "^2.5.1"
large-image-source-gdal = "^1.14.4"
large-image-source-tiff = "^1.14.5"
large-image-source-ometiff = "^1.14.5"
large-image-source-openjpeg = "^1.14.5"
mapnik = {url = "https://girder.github.io/large_image_wheels/mapnik-4.0.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl"}
libtiff = {url = "https://girder.github.io/large_image_wheels/libtiff-0.5.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl"}
large-image-source-mapnik = "^1.14.5"
pyvips = {url = "https://girder.github.io/large_image_wheels/pyvips-2.2.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl#sha256=7692c754ec393d7a3c2aedfd2cd7995161894bccadd638c0f1ef9c4ce2ae8a9e"}
python-javabridge = {url = "https://girder.github.io/large_image_wheels/python_javabridge-4.0.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl#sha256=e6e9ec84e0715f0a5bbb0b7cb50f47c00dec8fb1f638d2f84df4f61a8e64b6e8"}
pyproj = {url = "https://girder.github.io/large_image_wheels/pyproj-3.3.1.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl#sha256=54511e5418f2eea829b4ed017523dd777c4a4a4ca6e61ae06e4819bf249abf09"}
pylibtiff = {url = "https://girder.github.io/large_image_wheels/pylibtiff-0.5.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl#sha256=31d5ea015c4ae74e9a234a7aa847f16e24636224007b0d0a75f8f9763f95f49d"}
pylibmc = {url = "https://girder.github.io/large_image_wheels/pylibmc-1.7.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl#sha256=c1ab945bfc62abc0ae61d3fe03296634751b73cd030b663868c97809cc08d049"}
psutil = {url = "https://girder.github.io/large_image_wheels/psutil-5.7.3-cp38-cp38-manylinux2010_x86_64.whl#sha256=89be0d75f520f52737f26a4425fff253d33fb0bb65a2f2396587c8a036aa03ea"}

[tool.poetry.group.dev.dependencies]
numpy = "^1.21.4"
opencv-python = "^4.5.5"
tox = "^3.25.0"

[tool.poetry.scripts]
diveutils = "scripts.entrypoint_dev:cli"
dive = "scripts.entrypoint_main:cli"

[tool.poetry.plugins."girder.plugin"]
dive_server = "dive_server:GirderPlugin"
bucket_notifications = "bucket_notifications:GirderPlugin"
rabbit_user_queues = "rabbitmq_user_queues:GirderPlugin"

[tool.poetry.plugins."girder_worker_plugins"]
dive_tasks = "dive_tasks:DIVEPlugin"

[build-system]
requires = ["poetry-core>=1.0.0", "setuptools"]
build-backend = "poetry.core.masonry.api"
